<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="Ezequiel Tavella ">
<meta name="description"
    content="Ultimo post sobre el CTF de InfosecInstitute, esta vez con retos mas complicados&amp;hellip;
Level 11:
Al entrar en el reto nos encontramos con una imagen que nos indica que hay otro sonido de nuevo, pero mas abajo podemos ver que no hay ningun sonido sino una imagen del logo de php.
Debido a que en el reto anterior estaba esa imagen lol.gif, descargo php-logo-virus.jpg ya que me parece sospechosa y ejecutando:" />
<meta name="keywords" content="computers, network, hacking, security, research" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://ezequieltbh.me/posts/2015/03/es-ctf-infosecinstitute-parte-3/" />


<title>
    
    [ES] CTF InfosecInstitute - Parte 3 :: EzequielTBH Blog&#39;s 
    
</title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://ezequieltbh.me/main.min.91687bbfc139d7ff1a244bb6d7324425f9c4f424eaaad242b478e3b3cf56396a.css">



<link rel="apple-touch-icon" sizes="180x180" href="https://ezequieltbh.me/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://ezequieltbh.me/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://ezequieltbh.me/favicon-16x16.png">
<link rel="manifest" href="https://ezequieltbh.me/site.webmanifest">
<link rel="mask-icon" href="https://ezequieltbh.me/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="https://ezequieltbh.me/favicon.ico">
<meta name="theme-color" content="#252627">
<meta itemprop="name" content="[ES] CTF InfosecInstitute - Parte 3">
<meta itemprop="description" content="Ultimo post sobre el CTF de InfosecInstitute, esta vez con retos mas complicados&hellip;
Level 11:
Al entrar en el reto nos encontramos con una imagen que nos indica que hay otro sonido de nuevo, pero mas abajo podemos ver que no hay ningun sonido sino una imagen del logo de php.
Debido a que en el reto anterior estaba esa imagen lol.gif, descargo php-logo-virus.jpg ya que me parece sospechosa y ejecutando:">


<meta itemprop="datePublished" content="2015-03-16T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2015-03-16T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="824">



<meta itemprop="keywords" content="CTF,InfosecInstitute," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://ezequieltbh.me"/>

<meta name="twitter:title" content="[ES] CTF InfosecInstitute - Parte 3"/>
<meta name="twitter:description" content="Ultimo post sobre el CTF de InfosecInstitute, esta vez con retos mas complicados&hellip;
Level 11:
Al entrar en el reto nos encontramos con una imagen que nos indica que hay otro sonido de nuevo, pero mas abajo podemos ver que no hay ningun sonido sino una imagen del logo de php.
Debido a que en el reto anterior estaba esa imagen lol.gif, descargo php-logo-virus.jpg ya que me parece sospechosa y ejecutando:"/>




<meta property="article:published_time" content="2015-03-16 00:00:00 &#43;0000 &#43;0000" />







    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://ezequieltbh.me/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text"># </span>
            <span class="logo__cursor"></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://ezequieltbh.me/about/">About</a></li><li><a href="https://ezequieltbh.me/posts/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>4 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title"><a href="https://ezequieltbh.me/posts/2015/03/es-ctf-infosecinstitute-parte-3/">[ES] CTF InfosecInstitute - Parte 3</a></h1>

            

            <div class="post-content">
                <p>Ultimo post sobre el <strong>CTF</strong> de <strong>InfosecInstitute</strong>, esta vez con retos mas complicados&hellip;</p>

<p>Level 11:</p>

<p><img src="https://ezequieltbh.me/images/posts/ctf-infosecinstitute-3/2015-03-15 15_56_15-.jpg" alt="Level-11-10" /></p>

<p>Al entrar en el reto nos encontramos con una imagen que nos indica que hay otro sonido de nuevo, pero mas abajo podemos ver que no hay ningun sonido sino una imagen del logo de php.</p>

<p>Debido a que en el reto anterior estaba esa imagen <strong>lol.gif</strong>, descargo <strong>php-logo-virus.jpg</strong> ya que me parece sospechosa y ejecutando:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">strings php-logo-virus.jpg</code></pre></div>
<p>Me encuentro con:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">infosec_flagis_aHR0cDovL3d3dy5yb2xsZXJza2kuY28udWsvaW1hZ2VzYi9wb3dlcnNsaWRlX2xvZ29fbGFyZ2UuZ2lm</code></pre></div>
<p>Parece ser el flag, pero en realidad la ultima parte esta codificada en <strong>base 64</strong>, el no tener el <strong>&rdquo;=&rdquo;</strong> o <strong>&rdquo;==&rdquo;</strong> no significa que no sea <strong>base 64</strong> ya que el mismo se utiliza como <a href="https://en.wikipedia.org/wiki/Base64#Padding" target="_blank">padding</a> y no siempre es necesario.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">http://www.rollerski.co.uk/imagesb/powerslide_logo_large.gif</code></pre></div>
<p>Si vemos la imagen podemos encontrar la palabra powerslide que es la ultima parte de nuestro flag!</p>

<p><strong>Flag: infosec_flagis_powerslide</strong></p>

<p>Level 12:</p>

<p><img src="https://ezequieltbh.me/images/posts/ctf-infosecinstitute-3/2015-03-15 16_16_34.jpg" alt="Level-12-Css" /></p>

<p>Misma imagen que el reto 1 por lo que no encontraremos nada ahi, asi que hay que buscar en el codigo fuente de la web. Luego de un poco de busqueda nos encontramos con:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-HTML" data-lang="HTML">&lt;<span style="color:#f92672">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;css/custom.css&#34;</span>&gt;</code></pre></div>
<p>Eso no es un color me parece, pero si es hexadecimal!</p>

<p><strong>Flag: infosec_flagis_heyimnotacolor</strong></p>

<p>Level 13:</p>

<p><img src="https://ezequieltbh.me/images/posts/ctf-infosecinstitute-3/2015-03-15 16_22_43-.jpg" alt="Level-13-Reto-Perdido" /></p>

<p>Parece que el admin perdio el reto :p, nuestro objetivo es buscarlo asi que luego de probar algunas combinaciones comunes de nombres, la buena es:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">http://ctf.infosecinstitute.com/levelthirteen.php.old</code></pre></div>
<p>Si miramos el codigo fuente de esta nueva pagina veremos:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-HTML" data-lang="HTML">&lt;<span style="color:#f92672">p</span>&gt;Do you want to download this mysterious file?&lt;/<span style="color:#f92672">p</span>&gt;
 
   &lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;misc/imadecoy&#34;</span>&gt;
     &lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;btn&#34;</span>&gt;Yes&lt;/<span style="color:#f92672">button</span>&gt;
   &lt;/<span style="color:#f92672">a</span>&gt;</code></pre></div>
<p>Por lo que descargamos ese archivo <strong>imadecoy</strong> y mirandolo con un editor hexadecimal podemos ver que sus primeros tres bytes son <a href="http://www.filesignatures.net/index.php?page=search&amp;search=D4C3B2A1&amp;mode=SIG" target="_blank">d4 c3 b2</a>, los cuales son los bytes iniciales de un <strong>Pcap</strong> (Otra captura de red si).</p>

<p>Utilizando <strong>Wireshark</strong> para abrirlo se puede ver que hay varias conexiones <strong>HTTP</strong>, por lo que directamente vamos a <strong>&ldquo;Export Objects -&gt; HTTP&rdquo;</strong> y vemos todo lo que <strong>Wireshark</strong> pudo identificar en la captura.</p>

<p>Al parecer utilizaron <strong>&ldquo;Simple Vulnerable App&rdquo;</strong> desarrollado por <strong>&ldquo;Jay Turla, @shipcod3&rdquo;</strong> para realizar este reto, entre todos los objetos vemos uno llamado <strong>HoneyPY.PNG</strong> que contiene nuestro flag!</p>

<p><strong>Flag: infosec_flagis_morepackets</strong></p>

<p>Level 14:</p>

<p><img src="https://ezequieltbh.me/images/posts/ctf-infosecinstitute-3/2015-03-15 16_41_22-.jpg" alt="Level-14-SQL-Dump" /></p>

<p>Tenemos otro archivo para descargar y en la primera linea ya nos damos cuenta de que va este reto, tenemos una base de datos <strong>SQL</strong> que fue dumpeada.</p>

<p>Al parecer esa base de datos contenia una instalacion de <strong>Wordpress</strong> por lo que en principio uno piensa que el flag puede llegar a estar en algun hash de alguna contraseña, pero eso requeriria de bastante tiempo para crackearlo.</p>

<p>Descartado los hashes nos ponemos a buscar informacion que resulte sospechosa y buscando un poco nos encontramos con:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">--
-- Dumping data for table `friends`
--
 
INSERT INTO `friends` (`id`, `name`, `address`, `status`) VALUES
(102, &#39;Sasha Grey&#39;, &#39;Vatican City&#39;, &#39;Active&#39;),
(101, &#39;Andres Bonifacio&#39;, &#39;Tondo, Manila&#39;, &#39;Active&#39;),
(103, &#39;lol&#39;, &#39;what the???&#39;, &#39;Inactive&#39;),
(104, &#39;\\u0069\\u006e\\u0066\\u006f\\u0073\\u0065\\u0063\\u005f\\u0066\\u006c\\u0061\\u0067\\u0069\\u0073\\u005f\\u0077\\u0068\\u0061\\u0074\\u0073\\u006f\\u0072\\u0063\\u0065\\u0072\\u0079\\u0069\\u0073\\u0074\\u0068\\u0069\\u0073&#39;, &#39;annoying&#39;, &#39;0x0a&#39;);</code></pre></div>
<p>En el registro con <strong>id 104</strong> podemos ver que su &ldquo;nombre&rdquo; es un string en unicode ( \u te permite identificar unicode claramente), decodificandolo nos encontramos con el flag!</p>

<p><strong>Flag: infosec_flagis_whatsorceryisthis</strong></p>

<p>Level 15:</p>

<p>Ultimo y mas complicado reto.</p>

<p><img src="https://ezequieltbh.me/images/posts/ctf-infosecinstitute-3/2015-03-15 16_55_12.jpg" alt="Level-15-Command-Injection" /></p>

<p>Como podemos ver lo que tenemos es un campo que nos permite ingresar texto sin restricciones y que luego es procesado por el servidor usando <strong>PHP</strong> para ejecutar en el sistema el comando <strong>dig</strong> mas lo que nosotros hayamos ingresado en ese campo, claro ejemplo de <strong>Command Injection</strong>.</p>

<p>Para explotar este fallo simplemente en el campo escribimos</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">google.com;ls -lah</code></pre></div>
<p>Con esto la salida que nos va a devolver va a ser la de <strong>&ldquo;dig google.com&rdquo;</strong> y ademas la salida del comando <strong>&ldquo;ls -lah&rdquo;</strong> ya que el <strong>&rdquo;;&rdquo;</strong> en sistemas <strong>GNU/Linux</strong> funciona como indicador de que viene otro comando que debera ser ejecutado.</p>

<p><img src="https://ezequieltbh.me/images/posts/ctf-infosecinstitute-3/2015-03-15 17_02_13.jpg" alt="Level-15-Command-Injection-Exploit" /></p>

<p>Como se puede ver en la imagen en el mismo directorio hay un archivo <strong>.hey</strong> el cual contiene</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">Miux+mT6Kkcx+IhyMjTFnxT6KjAa+i6ZLibC</code></pre></div>
<p>Al parecer tenemos un texto codificado, intentando con varios cifrados encontramos el correcto: <a href="http://k4.cba.pl/dw/crypo/tools/eng_atom128c.html" target="_blank">ATOM-128</a></p>

<p><strong>Flag: infosec_flagis_rceatomized</strong></p>

<p>Bonus:</p>

<p>En el reto 15 como vemos hay un <strong>Command Injection</strong> que permite ejecutar comandos en el sistema operativo directamente, en competencias <strong>CTFs</strong> como esta normalmente estos retos estan muy controlados y limitados los comandos que uno puede ejecutar pero esto no es asi en este <strong>CTF</strong>.</p>

<p>He reportado este fallo con 2 emails a los organizadores pero hasta este momento no he tenido respuesta, asi que decidi publicarlo aca.</p>

<p>El fallo consiste en que no se limitan los comandos posibles a ejecutar por lo que uno puede hacer&hellip;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">google.com;uname -a</code></pre></div>
<p>Y obtener&hellip;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">Linux ip-1XX-3X-3X-XX 3.13.0-44-generic #73-Ubuntu SMP Tue Dec 16 XX:XX:XX UTC 2014 x86_64 x86_64 x86_64 GNU/Linux</code></pre></div>
<p>Y asi con otros comandos como <strong>cat /etc/passwd</strong>, id y cualquiera que pueda ser ejecutado con los privilegios de <strong>&ldquo;www-data&rdquo;</strong>.</p>

<p>Espero que los organizadores arreglen esto lo mas rapido posible.</p>

<p>Editado: He recibido respuesta por parte del organizador <strong>Ryan Fahey</strong>, indicando que aprecia mi nota sobre el nivel 15. Aun asi el fallo sigue sin ser arreglado hasta el dia de la fecha <strong>16/03/2015</strong>.</p>

<p>Este es el fin de mi Write-Up del <strong>CTF</strong> de <strong>InfosecInstitute</strong>.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://ezequieltbh.me/tags/ctf">CTF</a></span><span class="tag"><a href="https://ezequieltbh.me/tags/infosecinstitute">InfosecInstitute</a></span>
                </p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>824 Words</p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2015-03-15 21:00 -0300</p>
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h"></span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    
                        <span class="button previous">
                            <a href="https://ezequieltbh.me/posts/2015/03/es-desaf%C3%ADo-eset-29-write-up/">
                                <span class="button__icon">←</span>
                                <span class="button__text">[ES] Desafío ESET 29: Write Up</span>
                            </a>
                        </span>
                    

                    
                        <span class="button next">
                            <a href="https://ezequieltbh.me/posts/2015/03/es-ctf-infosecinstitute-parte-2/">
                                <span class="button__text">[ES] CTF InfosecInstitute - Parte 2</span>
                                <span class="button__icon">→</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
                <span><a href="https://ezequieltbh.me">Ezequiel Tavella</a></span>
            
            <span>All rights reserved.</span>
            <span> <a href="https://ezequieltbh.me/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">

        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="https://ezequieltbh.me/bundle.min.cf7871ed49474a80ed457154d24e61f7881adbe0f9384951a74ac46b688a39a4dbfa68bc6d37baeb058186de354ead3487d4ee7f083ea4cba860c48600b694f3.js" integrity="sha512-z3hx7UlHSoDtRXFU0k5h94ga2&#43;D5OElRp0rEa2iKOaTb&#43;mi8bTe66wWBht41Tq00h9Tufwg&#43;pMuoYMSGALaU8w=="></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-137782393-1', 'auto');
        ga('send', 'pageview');
    </script>



    </body>
</html>
