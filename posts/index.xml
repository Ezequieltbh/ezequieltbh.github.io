<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Posts on EzequielTBH Blog&#39;s</title>
        <link>https://ezequieltbh.me/posts/</link>
        <description>Recent content in Posts on EzequielTBH Blog&#39;s</description>
        <generator>Hugo -- gohugo.io</generator>
        <copyright>All rights reserved.</copyright>
        <lastBuildDate>Wed, 05 Aug 2015 00:00:00 +0000</lastBuildDate>
        <atom:link href="https://ezequieltbh.me/posts/index.xml" rel="self" type="application/rss+xml" />
        
        <item>
            <title>[ES] Cybercamp 2015 CTF: Criptografia challenge</title>
            <link>https://ezequieltbh.me/posts/2015/08/es-cybercamp-2015-ctf-criptografia-challenge/</link>
            <pubDate>Wed, 05 Aug 2015 00:00:00 +0000</pubDate>
            
            <guid>https://ezequieltbh.me/posts/2015/08/es-cybercamp-2015-ctf-criptografia-challenge/</guid>
            <description>El dia 17 de julio inicio el CTF 2015 de Cybercamp, el mismo era del estilo jeopardy y constaba de retos de criptografia, forensica, exploiting, web y reversing.
En mi caso termine en el puesto 44, tan solo a 4 de clasificar, una lastima no tener mas tiempo para dedicarlo a los retos.
Empezamos con uno de criptografia!
Descripcion: Se ha logrado interceptar dos criptogramas denominados C1 y C2, asi como sus correspondientes textos planos M1 y M2.</description>
            <content type="html"><![CDATA[<p>El dia 17 de julio inicio el CTF 2015 de Cybercamp, el mismo era del estilo jeopardy y constaba de retos de criptografia, forensica, exploiting, web y reversing.</p>

<p>En mi caso termine en el puesto 44, tan solo a 4 de clasificar, una lastima no tener mas tiempo para dedicarlo a los retos.</p>

<p>Empezamos con uno de criptografia!</p>

<p>Descripcion: Se ha logrado interceptar dos criptogramas denominados C1 y C2, asi como sus correspondientes textos planos M1 y M2. Se desea generar C3, el cual es el criptograma correspondiente a M3. Se sabe que el cifrado utilizado es DES-ECB.</p>

<p>Datos:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">M1 = INGRESAR ARACELI GONZALEZ 1.000
M2 = INGRESAR MANUEL FERNANDEZ 10.000
C1 = C4 41 ED E3 5C 67 4D D5 ED 61 A5 3F 72 1F E3 F4 9F 7E D0 56 6C 93 DE 1B 89 80 8E D0 95 75 C7 66
C2 = C4 41 ED E3 5C 67 4D D5 49 89 15 5D 3E 6B 2A A8 69 DF C0 30 B6 85 DC DE 82 9D EF 5D EB A1 D8 C1
M3 a cifrar: INGRESAR ARACELI GONZALEZ 10.000</code></pre></div>
<p>Como pueden ver a primera vista ya hay algo extraño, los primeros bytes de los dos criptogramas se repiten lo que nos hace pensar ya en un problema de confidencialidad como minimo.</p>

<p>Debido a que no hay ningun dato que nos permita obtener la Key de cifrado y que el algoritmo DES no es un cifrado reversible, hay que investigar un poco mas sobre ECB.</p>

<p>Con una busqueda rapida en Wikipedia nos encontramos con que este modo de operacion por bloques <a href="https://es.wikipedia.org/wiki/Cifrado_por_bloques#Electronic_Code-Book_.28ECB.29" target="_blank">ECB ( Electronic Code-book)</a>, tiene dos problemas: confidencialidad y replay attack.</p>

<p>El primero lo pudimos ver antes, si los bloques son iguales, sus textos planos coinciden.</p>

<p>El segundo es un ataque que se basa en el principio basico de este modo ECB: cada <strong>bloque se cifra independientemente</strong> del otro o de otra cosa. Con esto si necesitamos construir un criptograma nuevo, si tenemos sus textos planos y criptogramas correspondientes, tan solo hay que unir los bloques correspondientes.</p>

<p>Eso es lo que exactamente necesitamos para obtener el flag, asi que vamos a dividir los criptogramas en bloques de 8 bytes y obtenemos&hellip;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">M1 = i  n  g  r  e  s  a  r |  a  r  a  c  e  l  i   |    g  o  n  z  a  l  e | z     1  .  0  0  0  
C1 = C4 41 ED E3 5C 67 4D D5| ED 61 A5 3F 72 1F E3 F4| 9F 7E D0 56 6C 93 DE 1B| 89 80 8E D0 95 75 C7 66
C2 = C4 41 ED E3 5C 67 4D D5| 49 89 15 5D 3E 6B 2A A8| 69 DF C0 30 B6 85 DC DE| 82 9D EF 5D EB A1 D8 C1
M2 =  i  n  g  r  e  s  a  r|     m  a  n  u  e  l   |  f  e  r  n  a  n  d  e| z     1   0  .  0  0  0 </code></pre></div>
<p>Como podemos ver el primer bloque coincide en los dos criptogramas y ahora ya sabemos por que, para obtener el flag simplemente tomamos de C1 los primeros tres bloques ( &ldquo;ingresar araceli gonzale&rdquo;) y de C2 tomamos el ultimo bloque( &ldquo;z 10.000&rdquo;).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">C3 : C441EDE35C674DD5ED61A53F721FE3F49F7ED0566C93DE1B829DEF5DEBA1D8C1</code></pre></div>
<p>Con esto obtenemos el criptograma correspondiente el cual es valido y es nuestra flag!</p>

<p>Las recomendacion para evitar estos problemas son:</p>

<ol>
<li><p>No utilizar DES, es un algoritmo que se a probado que es vulnerable, utilizar AES el cual es su sucesor.</p></li>

<li><p>No utilizar ECB, debido a que tiene fallos de confidencialidad y es vulnerable al replay attack, utilizar otros modos como CBC, CFB, OFB y CTR.</p></li>
</ol>
]]></content>
        </item>
        
        <item>
            <title>[ES] CTF InfosecInstitute - Parte 2</title>
            <link>https://ezequieltbh.me/posts/2015/03/es-ctf-infosecinstitute-parte-2/</link>
            <pubDate>Sun, 15 Mar 2015 00:00:00 +0000</pubDate>
            
            <guid>https://ezequieltbh.me/posts/2015/03/es-ctf-infosecinstitute-parte-2/</guid>
            <description>Seguimos con los retos del CTF InfosecInstitute, esta vez del 6 al 10.
Level 6:
Nos encontramos con un Pcap, una captura de trafico de red asi que vamos a descargarla y ver que hay, utilizamos Wireshark para abrirla y nos encontramos con lo siguiente:
Demasiadas conexion cifradas TLS, al parecer se hizo una captura de un equipo que estaba navegando por HTTPS en una web, debido a que esta informacion viaja cifrada no podemos ver cual es el contenido a menos que se tenga el certificado del servidor el cual incluye la clave privada.</description>
            <content type="html"><![CDATA[<p>Seguimos con los retos del CTF InfosecInstitute, esta vez del 6 al 10.</p>

<p>Level 6:</p>

<p><img src="/images/posts/ctf-infosecinstitute-2/2015-03-14 17_19_23-.jpg" alt="Level-6-Captura-Red" /></p>

<p>Nos encontramos con un <strong>Pcap</strong>, una captura de trafico de red asi que vamos a descargarla y ver que hay, utilizamos <strong>Wireshark</strong> para abrirla y nos encontramos con lo siguiente:</p>

<p><img src="/images/posts/ctf-infosecinstitute-2/2015-03-14 17_23_26-.jpg" alt="Level-6-Captura-Red" /></p>

<p>Demasiadas conexion cifradas <strong>TLS</strong>, al parecer se hizo una captura de un equipo que estaba navegando por <strong>HTTPS</strong> en una web, debido a que esta informacion viaja cifrada no podemos ver cual es el contenido a menos que se tenga el certificado del servidor el cual incluye la clave privada.</p>

<p>Pero como no lo tenemos hay que buscar en los paquetes que no estan cifrados, sin ir mas lejos el primer paquete se puede observar en la imagen que contiene un string que llama la atencion&hellip;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">696e666f7365635f666c616769735f736e6966666564</code></pre></div>
<p>Despues de algunas pruebas, me encuentro que es un string con informacion hexadecimal que si lo decodificamos nos encontramos con el flag!</p>

<p><strong>Flag: infosec_flagis_sniffed</strong></p>

<p>Level 7:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">f00 not found
Something is not right here???
btw...bounty $70</code></pre></div>
<p>Eso es lo que nos muestra el reto, pero si vemos la url podemos ver que se esta viendo la URL <strong>404.php</strong>, pero normalmente los retos estan en <strong>level[Numero escrito en ingles].php</strong></p>

<p><img src="/images/posts/ctf-infosecinstitute-2/2015-03-14 17_38_30.jpg" alt="Level-7-Vacio-Blanco" /></p>

<p>No hay nada en esa URL, pero igualmente se puede accesar asi que hay que ver si hay algo escondido. Mirando bien los headers nos encontramos con lo siguiente:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">200 aW5mb3NlY19mbGFnaXNfeW91Zm91bmRpdA==</code></pre></div>
<p>200 OK es normalmente el status que devuelve una web si todo salio correctamente, y ahi hay un base64 asi que decodificandolo nos encontramos con el flag!</p>

<p><strong>Flag: infosec_flagis_youfoundit</strong></p>

<p>Level 8:</p>

<p><img src="/images/posts/ctf-infosecinstitute-2/2015-03-14 17_42_49.jpg" alt="Level-8-app-reversing" /></p>

<p>Misma imagen que antes pero distinta descarga: <strong>app.exe</strong>, ahora tenemos un ejecutable con lo que seguramente este reto sea sobre Reverse Engineering, el cual es el proceso de extraer informacion sobre el funcionamiento de algo sin tener informacion sobre el!</p>

<p>Para resolver este reto tenemos dos posibilidades:</p>

<ol>
<li><p>Utilizamos el comando <strong>string app.exe</strong> en Linux y mirando en la salida encontramos el flag.</p></li>

<li><p>Hacemos uso de <a href="https://www.hex-rays.com/products/ida/" target="_blank">IDA</a> o algun debugger y miramos cuales son los strings que almacena el ejecutable.</p></li>
</ol>

<p>En mi caso hice uso de Ida ya que crei que iba a ser un poco mas complejo el reto, para resolverlo simplemente iniciamos Ida y cuando haya terminado el analisis veremos lo siguiente:</p>

<p><img src="/images/posts/ctf-infosecinstitute-2/
2015-03-14 17_52_15-.jpg" alt="Level-8-app-reversing" /></p>

<p>Lo que ven es el codigo Assembler de <strong>app.exe</strong>, un pequeño programa que a simple vista muestra un mensaje y luego llama al comando <strong>netstat</strong>, si miramos bien encontraremos el flag el cual esta ubicado en la variable <strong>aInfosec_flagis</strong>.</p>

<p><strong>Flag: infosec_flagis_0x1a</strong></p>

<p>Level 9:</p>

<p><img src="/images/posts/ctf-infosecinstitute-2/2015-03-14 17_57_45.jpg" alt="Level-9-Login" /></p>

<p>En este nivel nos encontramos con un login el cual seguramente si lo pasamos obtendremos el flag, ahora la cuestion es como logearse correctamente.</p>

<p>Lo primero que se me vino a la mente fue utilizar <strong>SQL Injection</strong> asi que coloque una <strong>&lsquo;</strong> en el usuario y la contraseña, pero no tuve ninguna respuesta.</p>

<p>Debido a que es un <strong>CTF</strong> para <strong>&ldquo;noobs&rdquo;</strong> pense que la solucion seria mas sencilla por lo que empeze a comprobar credenciales por defecto, luego de varias pruebas encontre que <strong>root:attack</strong> era la combinacion correcta y me encontre con un alert que decia:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">ssaptluafed_sigalf_cesofni</code></pre></div>
<p>El cual es el flag pero dado vuelta!</p>

<p><strong>Flag: infosec_flagis_defaultpass</strong></p>

<p>Level 10:</p>

<p><img src="/images/posts/ctf-infosecinstitute-2/2015-03-14 18_07_02-.jpg" alt="Level-10-Audio" /></p>

<p>Nos encontramos con otra descarga pero esta vez es un audio un tanto extraño, se escucha algo acelerado pero no se puede entender nada.</p>

<p>Aca las posibilidades son 3:</p>

<ol>
<li><p>Esteganografia en el audio: habria que comprobar el histograma para ver si hay informacion guardada alli, tecnica <strong>LSB</strong>, adjunto de un archivo con algun programa (Steghide).</p></li>

<li><p>Metadatos</p></li>

<li><p>Reducir la velocidad de audio para ver si lo que hicieron fue acelerarlo solamente.</p></li>
</ol>

<p>Luego de algunas pruebas la posibilidad 3 es la correcta, utilizando <strong>Audacity</strong> hacemos un <strong>&ldquo;Cambio de velocidad&rdquo;</strong> y colocamos <strong>-88.00</strong> como <strong>&ldquo;Porcentaje de cambio&rdquo;</strong>, con eso podremos escuchar el flag, segun lo que puede escuchar es:</p>

<p><strong>Flag: infosec_flagis_sound</strong></p>

<p>Hasta aca la segunda parte, solo queda 1 con los ultimos 5 retos!</p>
]]></content>
        </item>
        
        <item>
            <title>[ES] CTF InfosecInstitute - Parte 1</title>
            <link>https://ezequieltbh.me/posts/2015/03/es-ctf-infosecinstitute-parte-1/</link>
            <pubDate>Sat, 14 Mar 2015 00:00:00 +0000</pubDate>
            
            <guid>https://ezequieltbh.me/posts/2015/03/es-ctf-infosecinstitute-parte-1/</guid>
            <description>El InfosecInstitute esta actualmente hosteando un CTF para &amp;ldquo;Noobs&amp;rdquo; con un bounty de $1200 dolares en total, que se distribuiran diferenciadamente entre los mejores Writeups para cada prueba.
En mi caso, los CTFs son una buena oportunidad para aprender asi que vamos alla.
Level 1:
En este nivel la frase lo dice todo: &amp;ldquo;Que el codigo fuente este con vosotros!&amp;rdquo;, asi que nos vamos a ver el codigo fuente de la web.</description>
            <content type="html"><![CDATA[<p>El <a href="https://resources.infosecinstitute.com/" target="_blank">InfosecInstitute</a> esta actualmente hosteando un <a href="http://ctf.infosecinstitute.com/" target="_blank">CTF</a> para &ldquo;Noobs&rdquo; con un bounty de $1200 dolares en total, que se distribuiran diferenciadamente entre los mejores Writeups para cada prueba.</p>

<p>En mi caso, los CTFs son una buena oportunidad para aprender asi que vamos alla.</p>

<p>Level 1:</p>

<p><img src="/images/posts/ctf-infosecinstitute-1/2015-03-14 00_48_30-.jpg" alt="Level-1-Source" /></p>

<p>En este nivel la frase lo dice todo: <strong>&ldquo;Que el codigo fuente este con vosotros!&rdquo;</strong>, asi que nos vamos a ver el codigo fuente de la web. Click derecho -&gt; Ver codigo fuente y en la primera linea nos encontramos con:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">&lt;!-- infosec_flagis_welcome --&gt;</code></pre></div>
<p>Un comentario de HTML con el Flag!</p>

<p><strong>Flag: infosec_flagis_welcome</strong></p>

<p>Level 2:</p>

<p><img src="/images/posts/ctf-infosecinstitute-1/2015-03-14 00_57_05-.jpg" alt="Level-2-Base64" /></p>

<p>Nos encontramos con una frase que nos indica que la imagen parece estar &ldquo;rota&rdquo;, y nos dice que si podemos revisar el archivo. Miramos el codigo fuente de la pagina y nos encontramos con lo siguiente:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-HTML" data-lang="HTML">&lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;lvlone&#34;</span>&gt;
   &lt;<span style="color:#f92672">img</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;img/leveltwo.jpeg&#34;</span> /&gt; </code></pre></div>
<p>Por lo que la imagen que buscamos esta en <strong>/img/leveltwo.jpeg</strong>, una vez guardada podemos ver que su contenido es:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">aW5mb3NlY19mbGFnaXNfd2VhcmVqdXN0c3RhcnRpbmc=</code></pre></div>
<p>Por el <strong>=</strong> del final uno se da cuenta rapidamente que se trata de Base64 un algoritmo de codificacion de texto muy utilizado especialemente en SMTP para envio de adjuntos y enviar la password.</p>

<p>Decodificandolo obtenemos el flag</p>

<p><strong><em>Flag: infosec_flagis_wearejuststarting</em></strong></p>

<p>Level 3:</p>

<p><img src="/images/posts/ctf-infosecinstitute-1/2015-03-14 03_54_41.jpg" alt="Level-3-Qrcode" /></p>

<p>En este nivel nos encontramos directamente con un <a href="https://es.wikipedia.org/wiki/C%C3%B3digo_QR" target="_blank">Qr Code</a>, el mismo es una imagen que es capaz de guardar informacion tanto texto como binario, podemos utilizar herramientas online o software para decodificar esa informacion.</p>

<p>En mi caso utilize la herramienta online <a href="http://zxing.org/" target="_blank">http://zxing.org/</a> y obtuve lo siguiente</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">.. -. ..-. --- ... . -.-. ..-. .-.. .- --. .. ... -- --- .-. ... .. -. --.</code></pre></div>
<p>Esto a simple vista uno puede reconocer que es codigo morse : cortos ( . ) y largos ( - ) repitiendose, decodificandolo con la herramienta <a href="https://morsecode.scphillips.com/translator.html" target="_blank">MorseCode</a> se obtiene el flag.</p>

<p><strong>Flag: INFOSECFLAGISMORSING</strong></p>

<p>Level 4:</p>

<p><img src="/images/posts/ctf-infosecinstitute-1/2015-03-14 04_06_12.jpg" alt="Level-4-Cookies" /></p>

<p>La frase lo dice todo: <strong>&ldquo;HTTP significa Hypertext Transfer Protocol&rdquo;</strong>, por lo que debemos buscar en algun elemento de HTTP, lo primero que se me viene a la mente son las cookies, si miramos las cookies nos encontramos con que hay una cookie de sesion llamada fusdorah cuyo contenido es</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">vasbfrp_syntvf_jrybirpbbxvrf</code></pre></div>
<p>Despues de algunas pruebas concluyo que esta codificado en <a href="https://es.wikipedia.org/wiki/Cifrado_C%C3%A9sar" target="_blank">Cesar</a>, un algoritmo de codificacion por desplazamiento, con la herramienta online <a href="https://www.dcode.fr/chiffre-cesar" target="_blank">Chiffre de Cesar</a> lo decodificamos y obtenemos el flag!</p>

<p><strong><em>Flag: INFOSECFLAGISWELOVECOOKIES</em></strong></p>

<p>Level 5 :</p>

<p>Al entrar en el reto nos encontramos con un loop infinito de un <strong>alert(&ldquo;Hacker&rdquo;);</strong> para seguir necesitamos pararlo asi que si usamos Firefox hacemos click en <strong>&ldquo;Evitar que esta pagina cree dialogos adicionales&rdquo;</strong> o si usamos otro navegador podes deshabilitar javascript antes de entrar.</p>

<p>Una vez entramos, nos encontramos con lo siguiente:</p>

<p><img src="/images/posts/ctf-infosecinstitute-1/2015-03-14 04_15_01.jpg" alt="Level-5-Esteganografia" /></p>

<p>Revisando el codigo fuente no encontramos nada&hellip; la imagen a simple vista no contiene nada oculto, si la revisamos con un editor hexadecimal no encontramos nada tampoco&hellip; Ok esto es esteganografia seguro&hellip;</p>

<p>Debido a que la imagen es jpeg descartamos LSB debido a la compresion que realiza el algoritmo, no hay un canal Alpha donde guardar pixeles que pueda guardar informacion asi que descartado tambien.</p>

<p>Una busqueda por google nos permite encontrar la <a href="https://ten4word.files.wordpress.com/2014/12/history-channel-meme-humans-i18.jpg" target="_blank">Imagen original</a> y podemos ver que la imagen en el reto tiene mayor peso, entonces se utilizo alguna herramienta para cifrar la informacion y guardarla dentro de la imagen.</p>

<p>Luego de algunas pruebas steghide es la herramienta que utilizaron</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">steghide extract -sf aliens.jpg
Password: </code></pre></div>
<p>Si, no hay password!</p>

<p>Se extrae un archivo llamado All.txt el cual contiene:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">011010010110111001100110011011110111001101100101011000110101111
10110011001101100011000010110011101101001011100110101111101110011
011101000110010101100111011000010110110001101001011001010110111001110011</code></pre></div>
<p>Binario&hellip; Si lo <a href="https://www.elhacker.net/convertidor.html" target="_blank">decodificamos</a> obtenemos la flag!</p>

<p><strong><em>Flag: infosec_flagis_stegaliens</em></strong></p>

<p>Y hasta aca los primeros 5 retos de este CTF, por el momento sencillos pero mas adelante se complica un poco mas.</p>
]]></content>
        </item>
        
    </channel>
</rss>
