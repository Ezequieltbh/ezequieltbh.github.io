<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Posts on EzequielTBH Blog&#39;s</title>
        <link>https://ezequieltbh.me/posts/</link>
        <description>Recent content in Posts on EzequielTBH Blog&#39;s</description>
        <generator>Hugo -- gohugo.io</generator>
        <copyright>All rights reserved.</copyright>
        <lastBuildDate>Wed, 05 Aug 2015 00:00:00 +0000</lastBuildDate>
        <atom:link href="https://ezequieltbh.me/posts/index.xml" rel="self" type="application/rss+xml" />
        
        <item>
            <title>[ES] Cybercamp 2015 CTF: Criptografia challenge</title>
            <link>https://ezequieltbh.me/posts/2015/08/es-cybercamp-2015-ctf-criptografia-challenge/</link>
            <pubDate>Wed, 05 Aug 2015 00:00:00 +0000</pubDate>
            
            <guid>https://ezequieltbh.me/posts/2015/08/es-cybercamp-2015-ctf-criptografia-challenge/</guid>
            <description>El dia 17 de julio inicio el CTF 2015 de Cybercamp, el mismo era del estilo jeopardy y constaba de retos de criptografia, forensica, exploiting, web y reversing.
En mi caso termine en el puesto 44, tan solo a 4 de clasificar, una lastima no tener mas tiempo para dedicarlo a los retos.
Empezamos con uno de criptografia!
Descripcion: Se ha logrado interceptar dos criptogramas denominados C1 y C2, asi como sus correspondientes textos planos M1 y M2.</description>
            <content type="html"><![CDATA[<p>El dia 17 de julio inicio el CTF 2015 de Cybercamp, el mismo era del estilo jeopardy y constaba de retos de criptografia, forensica, exploiting, web y reversing.</p>

<p>En mi caso termine en el puesto 44, tan solo a 4 de clasificar, una lastima no tener mas tiempo para dedicarlo a los retos.</p>

<p>Empezamos con uno de criptografia!</p>

<p>Descripcion: Se ha logrado interceptar dos criptogramas denominados C1 y C2, asi como sus correspondientes textos planos M1 y M2. Se desea generar C3, el cual es el criptograma correspondiente a M3. Se sabe que el cifrado utilizado es DES-ECB.</p>

<p>Datos:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">M1 = INGRESAR ARACELI GONZALEZ 1.000
M2 = INGRESAR MANUEL FERNANDEZ 10.000
C1 = C4 41 ED E3 5C 67 4D D5 ED 61 A5 3F 72 1F E3 F4 9F 7E D0 56 6C 93 DE 1B 89 80 8E D0 95 75 C7 66
C2 = C4 41 ED E3 5C 67 4D D5 49 89 15 5D 3E 6B 2A A8 69 DF C0 30 B6 85 DC DE 82 9D EF 5D EB A1 D8 C1
M3 a cifrar: INGRESAR ARACELI GONZALEZ 10.000</code></pre></div>
<p>Como pueden ver a primera vista ya hay algo extraño, los primeros bytes de los dos criptogramas se repiten lo que nos hace pensar ya en un problema de confidencialidad como minimo.</p>

<p>Debido a que no hay ningun dato que nos permita obtener la Key de cifrado y que el algoritmo DES no es un cifrado reversible, hay que investigar un poco mas sobre ECB.</p>

<p>Con una busqueda rapida en Wikipedia nos encontramos con que este modo de operacion por bloques <a href="https://es.wikipedia.org/wiki/Cifrado_por_bloques#Electronic_Code-Book_.28ECB.29" target="_blank">ECB ( Electronic Code-book)</a>, tiene dos problemas: confidencialidad y replay attack.</p>

<p>El primero lo pudimos ver antes, si los bloques son iguales, sus textos planos coinciden.</p>

<p>El segundo es un ataque que se basa en el principio basico de este modo ECB: cada <strong>bloque se cifra independientemente</strong> del otro o de otra cosa. Con esto si necesitamos construir un criptograma nuevo, si tenemos sus textos planos y criptogramas correspondientes, tan solo hay que unir los bloques correspondientes.</p>

<p>Eso es lo que exactamente necesitamos para obtener el flag, asi que vamos a dividir los criptogramas en bloques de 8 bytes y obtenemos&hellip;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">M1 = i  n  g  r  e  s  a  r |  a  r  a  c  e  l  i   |    g  o  n  z  a  l  e | z     1  .  0  0  0  
C1 = C4 41 ED E3 5C 67 4D D5| ED 61 A5 3F 72 1F E3 F4| 9F 7E D0 56 6C 93 DE 1B| 89 80 8E D0 95 75 C7 66
C2 = C4 41 ED E3 5C 67 4D D5| 49 89 15 5D 3E 6B 2A A8| 69 DF C0 30 B6 85 DC DE| 82 9D EF 5D EB A1 D8 C1
M2 =  i  n  g  r  e  s  a  r|     m  a  n  u  e  l   |  f  e  r  n  a  n  d  e| z     1   0  .  0  0  0 </code></pre></div>
<p>Como podemos ver el primer bloque coincide en los dos criptogramas y ahora ya sabemos por que, para obtener el flag simplemente tomamos de C1 los primeros tres bloques ( &ldquo;ingresar araceli gonzale&rdquo;) y de C2 tomamos el ultimo bloque( &ldquo;z 10.000&rdquo;).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Textfile" data-lang="Textfile">C3 : C441EDE35C674DD5ED61A53F721FE3F49F7ED0566C93DE1B829DEF5DEBA1D8C1</code></pre></div>
<p>Con esto obtenemos el criptograma correspondiente el cual es valido y es nuestra flag!</p>

<p>Las recomendacion para evitar estos problemas son:</p>

<ol>
<li><p>No utilizar DES, es un algoritmo que se a probado que es vulnerable, utilizar AES el cual es su sucesor.</p></li>

<li><p>No utilizar ECB, debido a que tiene fallos de confidencialidad y es vulnerable al replay attack, utilizar otros modos como CBC, CFB, OFB y CTR.</p></li>
</ol>
]]></content>
        </item>
        
    </channel>
</rss>
